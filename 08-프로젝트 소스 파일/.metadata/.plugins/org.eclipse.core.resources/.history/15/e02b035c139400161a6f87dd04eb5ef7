<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="QnaMemberJoinMapper">
	<resultMap type="com.bada_admin.model.QnaMemberJoin" id="qna_member_join">
		<result property="id" column="id" />
		<result property="subject" column="subject" />
		<result property="req_type" column="req_type" />
		<result property="content" column="content" />
		<result property="answer" column="answer" />
		<result property="answer_status" column="answer_status" />
		<result property="reg_date" column="reg_date" />
		<result property="edit_date" column="edit_date" />
		<result property="request_id" column="request_id" />
		<result property="request_name" column="request_name" />
		<result property="answer_id" column="answer_id" />
		<result property="answer_name" column="answer_name" />
	</resultMap>
	
	<!-- SELECT -->
	<!-- 문의 리스트 검색 -->
	<select id="selectQnaMemberJoinList" parameterType="com.bada_admin.model.QnaMemberJoin" resultMap="qna_member_join">
		SELECT
			qna.id AS id, ana.subject AS subject, qna.req_type AS req_type, qna.content AS content, qna.answer AS answer, 
			qna.answer_status AS answer_status, DATE_FORMAT(ana.reg_date, '%Y-%m-%d') AS reg_date, 
			DATE_FORMAT(qna.edit_date, '%Y-%m-%d') AS edit_date, member.name AS request_name, member.name AS answer_name
		FROM
			qna
		INNER JOIN 
			member
		ON
			request_id=member.id
			<if test="answer_id != null">
				AND answer_id=member.id
			</if>
		ORDER BY
			id DESC
		LIMIT
			#{limitStart}, #{listCount}
	</select>
</mapper>